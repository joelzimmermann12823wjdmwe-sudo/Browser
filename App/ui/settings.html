<!DOCTYPE html>
<html>
<head>
    <style>
        body { background: #0d1117; color: white; font-family: 'Segoe UI', sans-serif; padding: 40px; margin: 0; border: 1px solid #30363d; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; }
        .card { background: #161b22; padding: 25px; border-radius: 12px; border: 1px solid #30363d; margin-bottom: 30px; }
        .accent { color: #00d2ff; font-weight: bold; }
        .close-icon { cursor: pointer; color: #f85149; font-size: 28px; }
    </style>
</head>
<body>
    <div class="header">
        <h1 style="margin:0;">Einstellungen <small style="font-size:14px; color:#8b949e;">v1.2.3</small></h1>
        <div class="close-icon" onclick="window.close()">&times;</div>
    </div>

    <div class="card">
        <h3 style="margin-top:0;">📡 System Ressourcen</h3>
        <p>RAM-Nutzung: <span id="ramUsage" class="accent">Warte auf Daten...</span></p>
        <p>Engine Status: <span id="statusText" style="color:#8b949e">Verbinde...</span></p>
    </div>

    <div class="card">
        <h3>🎨 Personalisierung</h3>
        <p>Aktives Design: <span class="accent">Neon Dark (Standard)</span></p>
    </div>

    <script>
        let retryCount = 0;
        const maxRetries = 10;

        const initStats = () => {
            const ramElement = document.getElementById('ramUsage');
            const statusElement = document.getElementById('statusText');

            // Überprüfung, ob die API durch das Preload-Skript injiziert wurde
            if (window.electronAPI && typeof window.electronAPI.onSystemStats === 'function') {
                console.log("NEON API erfolgreich geladen.");
                window.electronAPI.onSystemStats(stats => {
                    if (ramElement) ramElement.innerText = stats.ram + " MB";
                    if (statusElement) {
                        statusElement.innerText = "Optimal";
                        statusElement.style.color = "#238636";
                    }
                });
            } else if (retryCount < maxRetries) {
                // Falls noch nicht geladen, kurz warten und erneut versuchen
                retryCount++;
                console.warn(`API nicht bereit. Versuch ${retryCount}/${maxRetries}...`);
                setTimeout(initStats, 200);
            } else {
                console.error("Fehler: electronAPI konnte nicht geladen werden.");
                if (ramElement) ramElement.innerText = "Fehler: Verbindung fehlgeschlagen";
                if (statusElement) {
                    statusElement.innerText = "API Error";
                    statusElement.style.color = "#f85149";
                }
            }
        };

        // Starten der Initialisierung
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initStats);
        } else {
            initStats();
        }
    </script>
</body>
</html>